{%extends 'base.html'%}
{% load static %}
{% load widget_tweaks %}
{% load crispy_forms_tags %}

{%block header%}
<div class="col-sm-6">
    <h1>Alimentar Histórico</h1>
</div>
<div class="col-sm-6">
    <ol class="breadcrumb float-sm-right">
        <li class="breadcrumb-item"><a href="{% url 'home_geral' %}">Inicio</a></li>
        <li class="breadcrumb-item active">Alimentar histórico</li>
    </ol>
</div>
{%endblock%}
{%block content%}
<div class="card card-primary">
    <div class="card-header ">
        <h5>Selecione um aluno</h5>
    </div>
    <div class="card-body">
        <form method="GET" id="form_busca" action="{% url 'add_historicos' %}">
            {% csrf_token %}
            <div class="row">
                <label>Alunos:</label>
                <div class="col-md-6">
                    <div class="form-group">
                        {% render_field formset.0.aluno class="form-control select2bs4"%}
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="col">
                        <button class="btn btn-secondary " type="submit"><i class="fas fa-search"></i></button>
                        <a class="btn btn-success" href="/admin/aluno/aluno/add/" target="_blank">
                            <i class="fas fa-user-plus"></i> Aluno</a>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>
<div class="card">
    <div class="card-header p-2">
        <ul class="nav nav-pills">
            <li class="nav-item"><a class="nav-link active" href="#notas" data-toggle="tab">Lançar Notas</a></li>
            <li class="nav-item"><a class="nav-link" href="#estudos" data-toggle="tab">Lançar Estudos</a></li>
        </ul>
    </div><!-- /.card-header -->
    <form method="POST" id="form_table_notas">
        <div class="card-body">
            <div class="tab-content" id="pills-tabContent">
                {% csrf_token %}
                <div class="tab-pane active" id="notas">
                    <!-- inicio tabela -->
                    <div class="card">
                        <div class="card-body" id="table" style="height: 100%;">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th scope=col class=text-center>Área de conhecimentos</th>
                                        <th scope=col class=text-center>1º Ano</th>
                                        <th scope=col class=text-center>2º Ano</th>
                                        <th scope=col class=text-center>3º Ano</th>
                                        <th scope=col class=text-center>4º Ano</th>
                                        <th scope=col class=text-center>5º Ano</th>
                                        <th scope=col class=text-center>6º Ano</th>
                                        <th scope=col class=text-center>7º Ano</th>
                                        <th scope=col class=text-center>8º Ano</th>
                                        <th scope=col class=text-center>9º Ano</th>
                                        <th scope=col class=text-center>AÇÃO</th>
                                    </tr>
                                </thead>
                                <tbody>
                                <tr>
                                    <td style="width:50px">
                                        {% render_field formset.0.disciplinas style="width:120px" class="form-group select2bs4"%}
                                    </td>
                                        {% for notas_formset in formset %}
                                            <td style="width:300px">
                                                <div id="item-{{ forloop.counter0 }}" class="input-group mb-1">
                                                    {% render_field notas_formset.nota class="form-control" placeholder="Digite" %}
                                                </div>
                                            </td>
                                        {% endfor %}
                                    <td>
                                        <button class="btn btn-success" type="button"><i class="fas fa-plus-circle"></i></button>    
                                    </td>   
                                </tr>           
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="tab-pane" id="estudos">
                    <div class="card">
                        <div class="card-body" id="table2" style="height: 100%;">
                        </div>
                    </div>
                </div>
            </div>
            <div class="row" style="margin-top: 20px;">
                <div class="col-10">
                    <button id="btn_salvar_notas" class="btn btn-primary" type="submit"> <i class="fas fa-save"></i>
                        Salvar</button>
                    <a id="btn_gerar_pdf" href="#" class="disabled btn btn-info" onclick="gerar_pdf()"><i
                            class="far fa-file-pdf"></i> GERAR PDF</a>
                </div>
            </div>
    </form>
</div>
</div>
{{ form.media.js }}

{% block scripts %}
<link rel="stylesheet" href="{% static 'css/historico.css' %}?version=1.2">
<script src="{% static 'js/historico.js' %}?version=1.2"></script>
<script>
        $('.select2bs4').select2();

</script>
<script>
    $(document).ready(function(){
        $("#add-item").click(function(ev) {
            ev.preventDefault();
            var count = $('#order').children().length;
            var tmplMarkup = $("#item-order").html();
            var compiledTmpl = tmplMarkup.replace(/__prefix__/g, count);
            $("div#order").append(compiledTmpl);

            // update form count
            $('#id_product-TOTAL_FORMS').attr('value', count + 1);

            // some animate to scroll to view our new form
            $('html, body').animate({
                scrollTop: $("#add-item").position().top-200
            }, 800);
        });
    });
</script>


{% endblock %}

{%endblock%}

{%block menu%}
<li class="nav-item">
    <a href="{% url 'home_geral' %}" class="nav-link">
        <i class="far fa-circle nav-icon"></i>
        <p>Home</p>
    </a>
</li>
<li class="nav-item">
    <a href="{% url 'historico' %}" class="nav-link active">
        <i class="far fa-circle nav-icon"></i>
        <p>Criar histórico</p>
    </a>
</li>
<li class="nav-item">
    <a href="/admin/aluno/aluno/" target="_blank" class="nav-link">
        <i class="far fa-circle nav-icon"></i>
        <p>Cadastro aluno</p>
    </a>
</li>
{%endblock%}

